
    -----------------------------------------------------------------------
          Psi4: An Open-Source Ab Initio Electronic Structure Package
                               Psi4 1.2a1.dev547 

                         Git: Rev {master} f5560a0 


    R. M. Parrish, L. A. Burns, D. G. A. Smith, A. C. Simmonett,
    A. E. DePrince III, E. G. Hohenstein, U. Bozkaya, A. Yu. Sokolov,
    R. Di Remigio, R. M. Richard, J. F. Gonthier, A. M. James,
    H. R. McAlexander, A. Kumar, M. Saitow, X. Wang, B. P. Pritchard,
    P. Verma, H. F. Schaefer III, K. Patkowski, R. A. King, E. F. Valeev,
    F. A. Evangelista, J. M. Turney, T. D. Crawford, and C. D. Sherrill,
    J. Chem. Theory Comput. 13(7) pp 3185--3197 (2017).
    (doi: 10.1021/acs.jctc.7b00174)

    -----------------------------------------------------------------------


    Psi4 started on: Thursday, 23 November 2017 11:13AM

    Process ID:   8083
    PSIDATADIR: /home/luke/Projects/psi4_build/psi_6/share/psi4
    Memory:     500.0 MiB
    Threads:    1
    
  ==> Input File <==

--------------------------------------------------------------------------

# PYTHONPATH must include directory above plugin directory.
#     Define either externally or here, then import plugin.
sys.path.insert(0, './..')
import syshfwplug
import psi4


plugin_load("./syshfwplug.so")


molecule mymol {
 Au                 0.35968923    0.69472540   -1.19378225
 Au                 5.51222143   -1.90804454   -1.57606317
 Au                -5.94155331    0.04722392   -2.67723809
 Au                -3.38269019    0.83301197   -3.77395737
 Au                -4.27370575   -0.49525376    2.82157939
 Au                -0.05215542    4.23420054    0.75236186
 Au                -2.28618122    1.26128971    3.68598618
 Au                 0.89633104   -2.85948993   -3.29690399
 Au                 0.77951688   -4.74650711   -1.25193406
 Au                -5.09672866   -0.42975342    0.00068435
 Au                 1.52242117   -0.13731982   -3.67674785
 Au                -1.28365882    1.44458524    0.91170583
 Au                 4.35173411   -2.29657525    0.96323678
 Au                 0.25196217   -0.04611219    4.13448029
 Au                 5.03890043    2.32638587    1.90975250
 Au                -5.71980306   -2.59175898    1.72294227
 Au                 4.96380504   -0.34818219    2.81679057
 Au                -4.12645040    1.88261918    1.39831129
 Au                 0.40888795   -0.80880730    1.17875746
 Au                -0.22215072   -2.72548996    3.16079477
 Au                 2.06373581    2.44992810   -2.62599910
 Au                 3.50090513   -4.01637355   -1.15942660
 Au                 0.25263294    2.61019622    3.20060623
 Au                 2.44541214   -1.55223736    3.07913940
 Au                -0.63378233    1.76558719   -3.63299397
 Au                -3.76962357   -1.64432597   -2.51488311
 Au                 1.71299163   -3.43721906    1.09563360
 Au                 3.57308273   -2.13804405   -3.59947935
 Au                 4.30248495    2.77779776   -0.79829838
 Au                -2.84435119    3.48513633   -3.10729979
 Au                -0.30743338    4.07863868   -2.04166675
 Au                 4.08398691    0.43294657   -2.34967294
 Au                 2.23518460    4.63446887   -0.88084168
 Au                -4.59816502    2.06428797   -1.36097006
 Au                 5.68062913    0.29650561    0.07975361
 Au                -2.65228823    3.74709898   -0.32748522
 Au                -2.23670619    3.75344941    2.45412861
 Au                -1.93198609   -0.85961556   -0.43805153
 Au                -1.07043183   -3.83162839    0.72793250
 Au                 2.49809807    3.46085858    1.65659225
 Au                 2.73305958    1.27181237    3.45024636
 Au                -1.22202009   -0.99268347   -3.62730227
 Au                -1.57785764   -3.33433770   -1.99709213
 Au                 2.76850561    0.71447098    0.57340846
 Au                -2.21211101   -1.35817012    4.63483945
 Au                -3.70276501   -3.08176505   -0.11068238
 Au                -3.05684210   -3.14181893    2.65796081
 Au                 2.26526254   -1.48571181   -1.04885281
symmetry c1
}

set {
  basis def2-qzvpp
}

set syshfwplug {
  pref mytest
  dryrun true
  do_tei 0
  print 1
}

set scf reference rhf
set scf_type pk
set scf PRINT_MOS  true

#e_scf,ref_wfn = energy('mp2',return_wfn=True)
ref_wfn = psi4.core.Wavefunction.build(mymol , psi4.core.get_global_option('BASIS'))
aux     = psi4.core.BasisSet.build(mymol, "DF_BASIS_SCF", "", "RIFIT", psi4.core.get_global_option('BASIS'))
aux2    = psi4.core.BasisSet.build(mymol, "DF_BASIS_MP2", "", "JKFIT", psi4.core.get_global_option('BASIS'))

ref_wfn.set_basisset("JKFIT",aux)
ref_wfn.set_basisset("RIFIT",aux2)

plugin("syshfwplug.so", ref_wfn)

#C = psi4.core.Matrix(ref_wfn.basisset().nbf(),ref_wfn.basisset().nbf())
#df = psi4.core.DFTensor(ref_wfn.basisset(), aux, C, 5 , ref_wfn.basisset().nbf()-5 )

#BQ2 = np.asarray(df.Qso())


#mints = MintsHelper(ref_wfn.basisset())
#I = np.asarray(mints.ao_eri())

#print "Check some ints:"
#for i in range(ref_wfn.basisset().nbf()):
#	print "{:16.8f} {:16.8f} {:16.8f} ".format(I[i,0,0,0] , np.sum([BQ2[Q][i,0]*BQ2[Q][0][0] for Q in range(aux.nbf())]), np.sum([BQ[Q][i,0]*BQ[Q][0][0] for Q in range(aux.nbf())]))

#syshfwplug.exampleFN(Qmn)
--------------------------------------------------------------------------
/home/luke/Projects/MP2-Project/src/syshfwplug/syshfwplug.so loaded.
   => Loading Basis Set <=

    Name: DEF2-QZVPP
    Role: ORBITAL
    Keyword: BASIS
    atoms 1-48 entry AU         line  4056 (ECP: line  5266) file /home/luke/Projects/psi4_build/psi_6/share/psi4/basis/def2-qzvpp.gbs 

    There are an even number of electrons - assuming singlet.
    Specify the multiplicity in the molecule input block.

   => Loading Basis Set <=

    Name: (DEF2-QZVPP AUX)
    Role: RIFIT
    Keyword: DF_BASIS_SCF
    atoms 1-48 entry AU         line  6066 file /home/luke/Projects/psi4_build/psi_6/share/psi4/basis/def2-qzvpp-ri.gbs 

   => Loading Basis Set <=

    Name: (DEF2-QZVPP AUX)
    Role: JKFIT
    Keyword: DF_BASIS_MP2
    atoms 1-48 entry AU         line  6152 file /home/luke/Projects/psi4_build/psi_6/share/psi4/basis/def2-qzvpp-jkfit.gbs 


Reading options from the SYSHFWPLUG block
Calling plugin syshfwplug.so.


    Molecular point group: c1
    Full point group: C1

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z               Mass       
    ------------   -----------------  -----------------  -----------------  -----------------
          AU          0.359689230208     0.694725400417    -1.193782249375   196.966568662000
          AU          5.512221430208    -1.908044539583    -1.576063169375   196.966568662000
          AU         -5.941553309792     0.047223920417    -2.677238089375   196.966568662000
          AU         -3.382690189792     0.833011970417    -3.773957369375   196.966568662000
          AU         -4.273705749792    -0.495253759583     2.821579390625   196.966568662000
          AU         -0.052155419792     4.234200540417     0.752361860625   196.966568662000
          AU         -2.286181219792     1.261289710417     3.685986180625   196.966568662000
          AU          0.896331040208    -2.859489929583    -3.296903989375   196.966568662000
          AU          0.779516880208    -4.746507109583    -1.251934059375   196.966568662000
          AU         -5.096728659792    -0.429753419583     0.000684350625   196.966568662000
          AU          1.522421170208    -0.137319819583    -3.676747849375   196.966568662000
          AU         -1.283658819792     1.444585240417     0.911705830625   196.966568662000
          AU          4.351734110208    -2.296575249583     0.963236780625   196.966568662000
          AU          0.251962170208    -0.046112189583     4.134480290625   196.966568662000
          AU          5.038900430208     2.326385870417     1.909752500625   196.966568662000
          AU         -5.719803059792    -2.591758979583     1.722942270625   196.966568662000
          AU          4.963805040208    -0.348182189583     2.816790570625   196.966568662000
          AU         -4.126450399792     1.882619180417     1.398311290625   196.966568662000
          AU          0.408887950208    -0.808807299583     1.178757460625   196.966568662000
          AU         -0.222150719792    -2.725489959583     3.160794770625   196.966568662000
          AU          2.063735810208     2.449928100417    -2.625999099375   196.966568662000
          AU          3.500905130208    -4.016373549583    -1.159426599375   196.966568662000
          AU          0.252632940208     2.610196220417     3.200606230625   196.966568662000
          AU          2.445412140208    -1.552237359583     3.079139400625   196.966568662000
          AU         -0.633782329792     1.765587190417    -3.632993969375   196.966568662000
          AU         -3.769623569792    -1.644325969583    -2.514883109375   196.966568662000
          AU          1.712991630208    -3.437219059583     1.095633600625   196.966568662000
          AU          3.573082730208    -2.138044049583    -3.599479349375   196.966568662000
          AU          4.302484950208     2.777797760417    -0.798298379375   196.966568662000
          AU         -2.844351189792     3.485136330417    -3.107299789375   196.966568662000
          AU         -0.307433379792     4.078638680417    -2.041666749375   196.966568662000
          AU          4.083986910208     0.432946570417    -2.349672939375   196.966568662000
          AU          2.235184600208     4.634468870417    -0.880841679375   196.966568662000
          AU         -4.598165019792     2.064287970417    -1.360970059375   196.966568662000
          AU          5.680629130208     0.296505610417     0.079753610625   196.966568662000
          AU         -2.652288229792     3.747098980417    -0.327485219375   196.966568662000
          AU         -2.236706189792     3.753449410417     2.454128610625   196.966568662000
          AU         -1.931986089792    -0.859615559583    -0.438051529375   196.966568662000
          AU         -1.070431829792    -3.831628389583     0.727932500625   196.966568662000
          AU          2.498098070208     3.460858580417     1.656592250625   196.966568662000
          AU          2.733059580208     1.271812370417     3.450246360625   196.966568662000
          AU         -1.222020089792    -0.992683469583    -3.627302269375   196.966568662000
          AU         -1.577857639792    -3.334337699583    -1.997092129375   196.966568662000
          AU          2.768505610208     0.714470980417     0.573408460625   196.966568662000
          AU         -2.212111009792    -1.358170119583     4.634839450625   196.966568662000
          AU         -3.702765009792    -3.081765049583    -0.110682379375   196.966568662000
          AU         -3.056842099792    -3.141818929583     2.657960810625   196.966568662000
          AU          2.265262540208    -1.485711809583    -1.048852809375   196.966568662000


    Nuclear repulsion energy:   39512.84887207

